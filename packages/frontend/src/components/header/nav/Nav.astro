---
import { SignedIn, OrganizationSwitcher } from "@clerk/astro/components";
import styles from "./nav.module.css";

let applicationPath = Astro.url.pathname;
const appPathFromIndexOne = "/" + applicationPath.split("/").slice(2).join("/");

if (
    !applicationPath.startsWith("/tickets") &&
    appPathFromIndexOne.startsWith("/tickets")
) {
    applicationPath = appPathFromIndexOne;
}
---

<SignedIn>
    <nav class="flex-row-between min-h-10">
        <div class="min-h-5 py-0.5">
            <OrganizationSwitcher
                afterSelectOrganizationUrl={applicationPath}
                afterSelectPersonalUrl={applicationPath}
                afterCreateOrganizationUrl={applicationPath}
                afterLeaveOrganizationUrl={applicationPath}
                skipInvitationScreen={true}
                appearance={{
                    elements: {
                        rootBox: styles.organizationSwitcher,
                    },
                }}
            />
        </div>
        <ul class="flex flex-row items-center justify-center gap-1">
            <li>
                <a href="/tickets">Tickets</a>
            </li>
            <li>
                <a href="/tickets/new">Create</a>
            </li>
            <li>
                <a href="/tickets/users">Users</a>
            </li>
        </ul>
    </nav>
</SignedIn>
